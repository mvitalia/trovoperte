<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1"> 
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<link rel="stylesheet" href="../css/jquery.mobile-1.4.5.min.css">
<link rel="stylesheet" href="../css/default_theme.min.css">
<link rel="stylesheet" href="../css/jquery.mobile.icons.min.css">
<link rel="stylesheet" href="../css/style.css">



<script src="../js/jquery-1.11.2.min.js"></script>
<script src="../js/jquery.mobile-1.4.5.min.js"></script>
<script src="../js/standard.js"></script>


</head>
<body>
    <!-- categorie -->
    <div data-role="page" id="page_dettaglio">
        <div data-role="header" data-position="fixed">
            <a href="#" data-rel="back" data-icon="back" data-position="inline" class="ui-btn-left" >&nbsp;</a>
            <a href="../index.html" data-role="none" class="link_index" data-ajax="false"><img src="../img/logo_trovoperte.png" class="logo_trovo" ></a>
			
            
            <div class="ui-btn-right">
                
                <a href="#settings" class="btn_settings" data-role="button" data-icon="gear">&nbsp;</a>
            </div>
            
        </div>
        
        <div role="main" id="" class="ui-content">
        	<div data-role="content">
                <div id="scheda_azienda" data-divider-theme="a" data-inset="true">
                		<span class="testo_finto">testo finto</span>
        		</div>
                
                
                <!-- gallery -->
                <div data-role="popup" id="azienda_gallery">
                  <div data-role="header">
                    <a href="#" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b ui-icon-delete ui-btn-icon-left" data-rel="back" data-icon="delete">&nbsp;</a>
                    <h1>Gallery</h1>
                  </div>
                
                  <div data-role="main" class="ui-content">
                    <!-- Swiper -->
                    <div id="scheda_gallery" data-divider-theme="a" data-inset="true">
                        <div class="swiper-container">
                            <div class="swiper-wrapper" id="lista_immagini">
                                
                            </div>
                            <!-- Add Pagination -->
                            <div class="swiper-pagination swiper-pagination-white"></div>
                            <!-- Add Arrows -->
                            <div class="swiper-button-next swiper-button-white"></div>
                            <div class="swiper-button-prev swiper-button-white"></div>
                        </div>                	
                    </div>
                    
                  </div>      
                
                  <div data-role="footer" data-position="fixed">
                    <a href="#page_info" data-icon="info" class="btn_info">info</a>    	
                  </div>
                </div> 
                
                
                <!-- news -->
                <div data-role="popup" id="azienda_news" >
                  <div data-role="header">
                    <a href="#" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b ui-icon-delete ui-btn-icon-left" data-rel="back" data-icon="delete">&nbsp;</a>
                    <h1>News</h1>
                  </div>
                
                  <div data-role="main" class="ui-content">
                    <div id="scheda_news" data-divider-theme="a" data-inset="true">
                    	<div class="swiper-container">
                            <div class="swiper-wrapper" id="lista_news">
                                
                            </div>
                            <!-- Add Pagination -->
                            <div class="swiper-pagination swiper-pagination-white"></div>
                            <!-- Add Arrows -->
                            <div class="swiper-button-next swiper-button-white"></div>
                            <div class="swiper-button-prev swiper-button-white"></div>
                        </div>                
                    </div>
                    
                  </div>
                
                  <div data-role="footer" data-position="fixed">
                    <a href="#" data-icon="info" class="btn_info">info</a>    	
                  </div>
                </div> 
                
                
                <!-- promo -->
              
                <div data-role="popup" id="azienda_promo">
                  <div data-role="header">
                    <a href="#" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b ui-icon-delete ui-btn-icon-left" data-rel="back" data-icon="delete">&nbsp;</a>
                    <h1>Promo</h1>
                  </div>
            
                  <div data-role="main" class="ui-content">
                    <div id="scheda_promo" data-divider-theme="a" data-inset="true">
                     	<div class="swiper-container">
                            <div class="swiper-wrapper" id="lista_promo">
                                
                            </div>
                            <!-- Add Pagination -->
                            <div class="swiper-pagination swiper-pagination-white"></div>
                            <!-- Add Arrows -->
                            <div class="swiper-button-next swiper-button-white"></div>
                            <div class="swiper-button-prev swiper-button-white"></div>
                        </div>               
                    </div>
                  </div>
            
                  <div data-role="footer" data-position="fixed">
                    <a href="#page_info" data-icon="info" class="btn_info">info</a>    	
                  </div>
                </div>
                
                
            </div>
        </div>
               
         <div data-role="footer" data-position="fixed">
            <div data-role="navbar" class="ui-navbar">
                <ul id="footer_dettaglio" class="ui-grid-c">
                	<!--<li class='ui-block-a' style="float:left;width:25%"><a href="#page_info" data-icon="info" data-iconpos="left" class="ui-state-persist"></a></li>-->
                    <span class="testo_finto">testo finto</span>
				</ul>
            </div>
        </div>
        
    </div><!--page-->

	
    
    
	

	<!-- setting -->
	<div id="settings" data-role="page">
            <div data-role="header">
                <a href="#" data-rel="back" data-icon="back" data-icon="back" >&nbsp;</a>
                <h1>Impostazioni</h1>
            </div>
            <div data-role="content">
                <ul data-role="listview">
                    <li><a href="#" class="small">Small</a></li>    
                    <li><a href="#" class="med">Medium</a></li>    
                    <li><a href="#" class="large">Large</a></li>    
                </ul>
            </div>
    </div>
    
    
    <!-- info -->
    <div data-role="page" data-dialog="true" id="page_info">
      <div data-role="header">
        <h1>Info</h1>
      </div>
    
      <div data-role="main" class="ui-content">
        Maurizio Voglino<br>
        <a href="mailto:info@mvitalia.com">info@mvitalia.com</a><br>
        <a href="http://www.mvitalia.com/" target="_blank">www.mvitalia.com</a></p>
        
      </div>
    
      <div data-role="footer">
        <h1></h1>
      </div>
    </div> 
    
</div>


<script>

$("#page_dettaglio").on("pageshow", function(event){
    var id_azienda = getParameterByName("id_azienda");
	
	$.getJSON("http://www.mvitalia.com/dimostrativi/patrizia/portaleapp/admin/get_json_data.asp?id_azienda=" + id_azienda, function(info_dettaglio){
	
		var scheda = "";
		var footer_dettaglio = "";
		
		var scheda_gallery,scheda_promo,scheda_news = "";
		var count_gallery,count_promo,count_news = 0;
		//container for $li to be added
		$.each(info_dettaglio, function (i, name) {
			//add the <li> to "li" variable
			//note the use of += in the variable
			//meaning I'm adding to the existing data. not replacing it.
			//store index value in array as id of the <a> tag
			if (name.id == id_azienda) {
				
				// IMMAGINE PRINCIPALE
				$.each(name.foto, function (i, foto) {
					if (foto.tipologia == 'principale') {
						scheda += "<img src='http://www.mvitalia.com/dimostrativi/patrizia/portaleapp%5Cpublic%5Cupload_gallery%5Cimmagini%5C" + foto.immagine + "' class='logo_azienda' >";
					}
					
					// GALLERY
					if (foto.tipologia == 'gallery') {
						scheda_gallery += "<div class='swiper-slide' style='background-image:url(http://www.mvitalia.com/dimostrativi/patrizia/portaleapp%5Cpublic%5Cupload_gallery%5Cimmagini%5C" + foto.immagine + ")'></div>";
						count_gallery += 1;
					}
			
					if (count_gallery == 0) {
						scheda_gallery += "Nessuna immagine da visualizzare";
					}
					
					if (name.tipo_contratto != 'intermedio') {
							
						// NEWS
						if (foto.tipologia == 'news') {
							scheda_news += "<div class='swiper-slide' style='background-image:url(http://www.mvitalia.com/dimostrativi/patrizia/portaleapp%5Cpublic%5Cupload_gallery%5Cimmagini%5C" + foto.immagine + ")'></div>";
							count_news += 1;
						}
				
						if (count_news == 0) {
							scheda_news += "Nessuna immagine da visualizzare";
						}
						
						
						// PROMO
						if (foto.tipologia == 'promo') {
							scheda_promo += "<div class='swiper-slide' style='background-image:url(http://www.mvitalia.com/dimostrativi/patrizia/portaleapp%5Cpublic%5Cupload_gallery%5Cimmagini%5C" + foto.immagine + ")'></div>";
							count_promo += 1;
						}
				
						if (count_promo == 0) {
							scheda_promo += "Nessuna immagine da visualizzare";
						}
					}
					
				});
				
				scheda += "<div class='info_azienda'><h1>" + name.ragione_sociale + "</h1>"; // RAGIONE SOCIALE
				scheda += "<p>" + name.indirizzo + " " + name.num + "</p><p>" + name.cap + " " + name.paese + " " + name.provincia + "</div>"; // INDIRIZZO
				
				if (name.tipo_contratto != 'base'){
					scheda +="<div class='box_extra'><a id=" + name.id + " href='#azienda_gallery' data-icon='camera' data-rel='popup' data-position-to='window' data-transition='pop' class='azienda_gallery ui-btn ui-shadow ui-btn-inline ui-icon-heart ui-btn-icon-left' >Gallery</a>";
	
					if (name.tipo_contratto != 'intermedio') {
						scheda +="<a id=" + name.id + " href='#azienda_news' data-icon='calendar' data-rel='popup' data-position-to='window' data-transition='pop' class='azienda_news ui-btn ui-shadow ui-btn-inline ui-icon-heart ui-btn-icon-left'>News</a>";
						scheda +="<a id=" + name.id + " href='#azienda_promo' data-icon='heart' class='azienda_promo ui-btn ui-shadow ui-btn-inline ui-icon-heart ui-btn-icon-left' data-rel='popup' data-position-to='window' data-transition='pop'>Promo</a>";
												
					}
					scheda +="</div>"
				}
				
				//scheda += "<div data-role='collapsibleset' data-theme='a' data-content-theme='a' class='ui-collapsible-set ui-group-theme-a ui-corner-all descrizione'>";
				
				// DESCRIZIONE
				//scheda += "<div data-role='collapsible' data-collapsed='false' class='ui-collapsible ui-collapsible-inset ui-corner-all ui-collapsible-themed-content ui-first-child ui-collapsible-collapsed'><h3 class='ui-collapsible-heading ui-collapsible-heading-collapsed'><a href='#' class='ui-collapsible-heading-toggle ui-btn ui-btn-icon-left ui-btn-a ui-icon-plus'>Descrizione<span class='ui-collapsible-heading-status'>click to expand contents</span></a></h3><div class='ui-collapsible-content ui-body-a ui-collapsible-content-collapsed' aria-hidden='false'><p>" + name.descrizione + "</p></div></div>";
				
				// SERVIZI
				//scheda += "<div data-role='collapsible' class='ui-collapsible ui-collapsible-inset ui-corner-all ui-collapsible-themed-content ui-first-child ui-collapsible-collapsed'><h3 class='ui-collapsible-heading ui-collapsible-heading-collapsed'><a href='#' class='ui-collapsible-heading-toggle ui-btn ui-btn-icon-left ui-btn-a ui-icon-plus'>Servizi<span class='ui-collapsible-heading-status'>click to expand contents</span></a></h3><div class='ui-collapsible-content ui-body-a ui-collapsible-content-collapsed' aria-hidden='true'><p>" + name.servizi + "</p></div></div>";
				
				//scheda += "</div>";
				scheda += "<div class='descrizione'><h3>Descrizione</h3>" + name.descrizione + "</div>"; // DESCRIZIONE
				scheda += "<div class='servizi'><h3>Servizi</h3>" + name.servizi  + "</div>"; // SERVIZI
				
				//<li class='ui-block-a' style="float:left;width:25%"><a href="#page_info" data-icon="info" data-iconpos="left" class="ui-state-persist"></a></li>
				//footer_dettaglio = "<li class='ui-block-a' style='float:left;width:25%'><a href='page_info' data-icon='info' data-role='button' class='ui-btn ui-state-persist ui-btn-up-a ui-btn-inline ui-icon-info ui-btn-icon-left'>Info</a></li>";
				footer_dettaglio += "<li class='ui-block-a' style='float:left;width:25%'><a href='http://" + name.web + "' data-icon='navigation' data-role='button' class='btn_web ui-btn ui-state-persist ui-btn-up-a ui-btn-inline ui-icon-navigation ui-btn-icon-left'>Web</a></li>";
				footer_dettaglio += "<li class='ui-block-b '><a href='mailto:" + name.mail + "' data-icon='mail' data-role='button' class='btn_mail ui-btn ui-state-persist ui-btn-up-a ui-btn-inline ui-icon-mail ui-btn-icon-left'>E-mail</a></li>";
				footer_dettaglio += "<li class='ui-block-c '><a href='tel:" + name.tel + "' data-icon='phone' data-role='button'  class='btn_tel ui-btn ui-state-persist ui-btn-up-a ui-btn-inline ui-icon-phone ui-btn-icon-left'>Tel.</a></li>";
				footer_dettaglio += "<li class='ui-block-d '><a href='tel:" + name.fax + "' data-role='button' class='btn_fax ui-btn ui-state-persist ui-btn-up-a ui-btn-inline ui-btn-icon-left'>fax</a></li>"; // RIFERIMENTI
				
				
				
			}
		});
		//append list to ul
		var htmlObject = $(scheda);
		$("#footer_dettaglio").empty();
		$("#footer_dettaglio").append(footer_dettaglio).promise().done(function () {});
		$("#scheda_azienda").empty();
		$("#scheda_azienda").append(htmlObject).promise().done(function () {});
		$("#lista_immagini").append(scheda_gallery).promise().done(function () {});
		
		if (name.tipo_contratto != 'intermedio') {
			$("#lista_promo").append(scheda_promo).promise().done(function () {});
			$("#lista_news").append(scheda_news).promise().done(function () {});
		}
	});
})   



</script>
</body>
</html>